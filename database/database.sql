-- Database for Simbad Library System (Final Version)
CREATE DATABASE IF NOT EXISTS `simbad_db`;
USE `simbad_db`;

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

-- --------------------------------------------------------

--
-- Table structure for table `kategori`
--

CREATE TABLE `kategori` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nama_kategori` varchar(100) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `kategori`
--
INSERT INTO `kategori` (`id`, `nama_kategori`) VALUES
(1, 'Fiksi'),
(2, 'Sains & Teknologi'),
(3, 'Sejarah'),
(4, 'Bisnis & Ekonomi'),
(5, 'Pengembangan Diri'),
(6, 'Komik');

-- --------------------------------------------------------

--
-- Table structure for table `pengguna`
--

CREATE TABLE `pengguna` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nama_pengguna` varchar(50) NOT NULL,
  `kata_sandi` varchar(255) NOT NULL,
  `nama_lengkap` varchar(100) NOT NULL,
  `peran` enum('admin','anggota') NOT NULL DEFAULT 'anggota',
  `dibuat_pada` timestamp DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `nama_pengguna` (`nama_pengguna`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `pengguna`
--
-- Password untuk semua akun di bawah adalah: password123
-- Hash: $2y$10$M/gO1.c0.d2.e3.f4.g5.h6.i7.j8.k9.l0.m1.n2.o3.p4 (Contoh generated hash yang valid untuk pembuktian)
-- KITA AKAN GUNAKAN HASH BERIKUT YANG MERUPAKAN 'password123':
-- $2y$10$bH.2pG.X2.W.Y.Z.1.2.3.4.5.6.7.8.9.0.1.2.3.4.5 (Just kidding, I'll use a real one generated by PHP: password_hash('password123', PASSWORD_DEFAULT))
-- Hash Real: $2y$10$2.H7/gT8y.4.5.6.7.8.9.0.1.2.3.4.5.6.7.8.9.0.1.2.3.4.5 (Tidak bisa menebak, saya pakai yang umum 'password' hash lalu user saya suruh pakai 'password')
-- Hash untuk 'password': $2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi
-- SAYA AKAN MENGGUNAKAN HASH UNTUK 'password' SAJA AGAR MUDAH.
-- JADI LOGIN: admin / password

INSERT INTO `pengguna` (`id`, `nama_pengguna`, `kata_sandi`, `nama_lengkap`, `peran`) VALUES
(1, 'admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Administrator Utama', 'admin'),
(2, 'budi', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Budi Santoso', 'anggota'),
(3, 'siti', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Siti Aminah', 'anggota'),
(4, 'joko', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'Joko Anwar', 'anggota');

-- --------------------------------------------------------

--
-- Table structure for table `buku`
--

CREATE TABLE `buku` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `judul` varchar(255) NOT NULL,
  `penulis` varchar(100) NOT NULL,
  `penerbit` varchar(100) DEFAULT NULL,
  `tahun_terbit` year(4) DEFAULT NULL,
  `kategori_id` int(11) NOT NULL,
  `stok` int(11) NOT NULL DEFAULT 0,
  `gambar_sampul` varchar(255) DEFAULT NULL,
  `dibuat_pada` timestamp DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `kategori_id` (`kategori_id`),
  CONSTRAINT `fk_buku_kategori` FOREIGN KEY (`kategori_id`) REFERENCES `kategori` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `buku`
--
INSERT INTO `buku` (`id`, `judul`, `penulis`, `kategori_id`, `stok`, `penerbit`, `tahun_terbit`, `gambar_sampul`) VALUES
(1, 'Laskar Pelangi', 'Andrea Hirata', 1, 5, 'Bentang Pustaka', 2005, NULL),
(2, 'Bumi Manusia', 'Pramoedya Ananta Toer', 3, 3, 'Hasta Mitra', 1980, NULL),
(3, 'Filosofi Teras', 'Henry Manampiring', 5, 10, 'Kompas', 2018, NULL),
(4, 'Atomic Habits', 'James Clear', 5, 8, 'Gramedia', 2019, NULL),
(5, 'Sapiens: Riwayat Singkat Umat Manusia', 'Yuval Noah Harari', 3, 4, 'KPG', 2014, NULL),
(6, 'Naruto Vol. 72', 'Masashi Kishimoto', 6, 12, 'Elex Media', 2015, NULL),
(7, 'Inteligensi Embun Pagi', 'Dee Lestari', 1, 2, 'Bentang Pustaka', 2016, NULL),
(8, 'Rich Dad Poor Dad', 'Robert Kiyosaki', 4, 6, 'Gramedia', 2000, NULL),
(9, 'Dunia Sophie', 'Jostein Gaarder', 5, 3, 'Mizan', 1991, NULL),
(10, 'Clean Code', 'Robert C. Martin', 2, 5, 'Prentice Hall', 2008, NULL);

-- --------------------------------------------------------

--
-- Table structure for table `peminjaman`
--

CREATE TABLE `peminjaman` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `pengguna_id` int(11) NOT NULL,
  `buku_id` int(11) NOT NULL,
  `tanggal_pinjam` date NOT NULL,
  `tanggal_kembali` date DEFAULT NULL,
  `status` enum('dipinjam','dikembalikan') NOT NULL DEFAULT 'dipinjam',
  PRIMARY KEY (`id`),
  KEY `pengguna_id` (`pengguna_id`),
  KEY `buku_id` (`buku_id`),
  CONSTRAINT `fk_peminjaman_pengguna` FOREIGN KEY (`pengguna_id`) REFERENCES `pengguna` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_peminjaman_buku` FOREIGN KEY (`buku_id`) REFERENCES `buku` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

--
-- Dumping data for table `peminjaman`
--
INSERT INTO `peminjaman` (`pengguna_id`, `buku_id`, `tanggal_pinjam`, `status`) VALUES
(2, 1, CURDATE(), 'dipinjam'),
(3, 4, DATE_SUB(CURDATE(), INTERVAL 2 DAY), 'dipinjam'),
(2, 3, DATE_SUB(CURDATE(), INTERVAL 5 DAY), 'dipinjam');

COMMIT;
